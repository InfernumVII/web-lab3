<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="jakarta.faces.core">

<h:head>
    <title>web-lab3</title>
    <h:outputStylesheet library="css" name="main-page-styles.css"/>
    <h:outputScript library="js" name="script1.js"/>
</h:head>
<h:body>
    <div class="particles" id="particles"></div>
    <div id="header">
        <h:head>
            <h:outputStylesheet library="css" name="header-styles.css"/>
        </h:head>
        <div class="header-item" id="full-name">ФИО: Швецов Егор Максимович</div>
        <div class="header-item" id="group-number">Номер группы: P3206</div>
        <div class="header-item" id="variant">Вариант: 468074</div>
    </div>

    <div id="content">
        <h:head>
            <h:outputStylesheet library="css" name="main-page-content-styles.css"/>
        </h:head>

        <h:form style="display:none;">
            <p:remoteCommand name="sendClickParams"
                                action="#{pointBean.addPointFromGraph}"
                                update="xyR-form result-table-wrapper points-data-script" 
                                oncomplete="drawPoints()" />
        </h:form>
        <div class="first-row">
            <div class="chart">
                <svg width="440" height="440" >
                    <polygon class="figures" points="220,220 220,132 132,220"></polygon>
                    <rect class="figures" x="220" y="132" width="176" height="88"/>
                    <defs>
                        <clipPath id="half-half-circle">
                            <rect x="44" y="220" width="176" height="176"/>
                        </clipPath>
                    </defs>
                    <circle class="figures" cx="220" cy="220" r="176" clip-path="url(#half-half-circle)"/>
                    <!--y strokes plus-->
                    <line x1="215" x2="225" y1="132" y2="132" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="226" y="134">R/2</text>
                    <line x1="215" x2="225" y1="44" y2="44" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="226" y="46">R</text>
                    <!--y strokes minus-->
                    <line x1="215" x2="225" y1="308" y2="308" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="226" y="310">-R/2</text>
                    <line x1="215" x2="225" y1="396" y2="396" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="226" y="398">-R</text>
                    <!--y arrow -->
                    <text x="225" y="10">y</text>
                    <line x1="220" x2="220" y1="440" y2="0" stroke="white" fill="transparent" stroke-width="1"/>
                    <line x1="220" x2="215" y1="0" y2="5" stroke="white" fill="transparent" stroke-width="1"/>
                    <line x1="220" x2="225" y1="0" y2="5" stroke="white" fill="transparent" stroke-width="1"/>
                    
                    <!--x strokes plus-->
                    <line x1="308" x2="308" y1="215" y2="225" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="304" y="213">R/2</text>
                    <line x1="396" x2="396" y1="215" y2="225" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="392" y="213">R</text>
                    <!--x strokes minus-->
                    <line x1="132" x2="132" y1="215" y2="225" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="128" y="213">-R/2</text>
                    <line x1="44" x2="44" y1="215" y2="225" stroke="white" fill="transparent" stroke-width="1"/>
                    <text x="40" y="213">-R</text>
                    <!--x arrow -->
                    <text x="430" y="235">x</text>
                    <line x1="0" x2="440" y1="220" y2="220" stroke="white" fill="transparent" stroke-width="1"/>
                    <line x1="440" x2="435" y1="220" y2="215" stroke="white" fill="transparent" stroke-width="1"/>
                    <line x1="440" x2="435" y1="220" y2="225" stroke="white" fill="transparent" stroke-width="1"/>
                    
                    <circle class="point" cx="220" cy="220" r="5"/>
                </svg>
            </div>
            
            <div id="info-table">
                <h:panelGroup id="result-table-wrapper">
                    
                    <h:dataTable id="result-table" value="#{resultsController.results}" var="res">
                        
                        <h:column>
                            <f:facet name="header">X</f:facet>
                            #{res.x}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Y</f:facet>
                            #{res.y}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">R</f:facet>
                            #{res.r}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Current Time</f:facet>
                            #{res.currentTime}
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Execution Time</f:facet>
                            #{res.executionTime} micros
                        </h:column>
                        
                        <h:column>
                            <f:facet name="header">Success</f:facet>
                            <h:outputText value="#{res.success ? 'HIT' : 'MISS'}" 
                                          style="color: #{res.success ? '#00FF00' : '#FF0000'}; font-weight: bold;"/>
                        </h:column>
                        
                    </h:dataTable>
            
                    <h:panelGroup id="points-data-script">
                        <script>
                            if (typeof updatePoints === "function") {
                                updatePoints([
                                    <ui:repeat value="#{resultsController.results}" var="r" varStatus="status">
                                        { x: #{r.x}, y: #{r.y}, r: #{r.r}, success: #{r.success} }#{status.last ? '' : ','}
                                    </ui:repeat>
                                ]);
                            }
                        </script>
                    </h:panelGroup>
            
                </h:panelGroup>
            </div>

            
            
        </div>
        <h:form id="xyR-form">
        
            <fieldset>
                <legend>X</legend>
                <h:selectOneRadio value="#{pointBean.x}" styleClass="radio-group">
                    <f:selectItem itemValue="-5" itemLabel="-5" />
                    <f:selectItem itemValue="-4" itemLabel="-4" />
                    <f:selectItem itemValue="-3" itemLabel="-3" />
                    <f:selectItem itemValue="-2" itemLabel="-2" />
                    <f:selectItem itemValue="-1" itemLabel="-1" />
                    <f:selectItem itemValue="0" itemLabel="0" />
                    <f:selectItem itemValue="1" itemLabel="1" />
                    <f:selectItem itemValue="2" itemLabel="2" />
                    <f:selectItem itemValue="3" itemLabel="3" />
                </h:selectOneRadio>
            </fieldset>
        
            <fieldset>
                <legend>Y</legend>
                <p:inputText id="y-input" value="#{pointBean.y}" 
                             required="true"
                             placeholder="(-5 ... 5)"
                             maxlength="10"
                             styleClass="custom-input">
                    
                    <f:converter converterId="jakarta.faces.BigDecimal" />
                    
                    <f:validateDoubleRange minimum="-5.0" maximum="5.0" />
                    
                </p:inputText>
                <p:message for="y-input" styleClass="error-message" display="text" />
            </fieldset>
        
            <fieldset>
                <legend>R</legend>
                <div style="margin-bottom: 10px;">
                    <h:outputText value="Value: " />
                    
                    <p:inputText id="r-val" value="#{pointBean.r}" 
                                 styleClass="custom-input" 
                                 onchange="drawPoints()"
                                 style="width: 50px; text-align: center;">
                         <f:converter converterId="jakarta.faces.BigDecimal" />
                    </p:inputText>
                </div>
            
                <p:slider for="r-val" minValue="1" maxValue="4" step="0.25" 
                          styleClass="custom-slider"
                          onSlideEnd="drawPoints()">
                     
                     <p:ajax event="slideEnd" process="r-val" />
                </p:slider>
            </fieldset>
        
            <div>
                <p:commandButton value="SUBMIT" 
                    action="#{pointBean.submit}" 
                    update="@form result-table-wrapper points-data-script" 
                    oncomplete="drawPoints()"
                    styleClass="gradient-button" />
            </div>
        
        </h:form>
        
    </div>
    <h:button id="to-welcome-page" outcome="welcome" value="{--"/>
</h:body>

</html>